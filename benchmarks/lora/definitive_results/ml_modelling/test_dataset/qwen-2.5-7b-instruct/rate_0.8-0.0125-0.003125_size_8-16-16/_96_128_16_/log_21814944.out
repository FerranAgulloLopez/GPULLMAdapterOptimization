INFO 06-01 15:55:22 [__init__.py:239] Automatically detected platform cuda.
Namespace(backend='openai', base_url=None, host='localhost', port=38872, endpoint='/v1/completions', dataset=None, dataset_name='sharegpt', dataset_path='/gpfs/scratch/bsc98/bsc098069/llm_benchmarking/data/ShareGPT_V3_unfiltered_cleaned_split.json', model='/gpfs/scratch/bsc98/bsc098069/llm_benchmarking/models/qwen/qwen-2.5-7b-instruct', tokenizer=None, sharegpt_output_len=None, seed=0, trust_remote_code=False, save_result=True, metadata=None, result_dir='benchmarks/lora/definitive_results/finding_maximum/test_dataset/with_offloading/qwen-2.5-7b-instruct/rate_0.8-0.0125-0.003125_size_8-16-16/_96_128_16_', launch_server=True, server_args='--port=38872 --disable-log-requests --model="/gpfs/scratch/bsc98/bsc098069/llm_benchmarking/models/qwen/qwen-2.5-7b-instruct" --enable-lora --dummy-lora-modules="/gpfs/scratch/bsc98/bsc098069/llm_benchmarking/models/qwen/qwen-2.5-7b-instruct/lora/lora-medical_dummy_rank_8/ /gpfs/scratch/bsc98/bsc098069/llm_benchmarking/models/qwen/qwen-2.5-7b-instruct/lora/lora-medical_dummy_rank_16/ /gpfs/scratch/bsc98/bsc098069/llm_benchmarking/models/qwen/qwen-2.5-7b-instruct/lora/lora-medical_dummy_rank_16/" --max-num-seqs="2048" --scheduler-cls="vllm.v1.core.sched.scheduler.Scheduler" --no-enable-prefix-caching --max-loras=96 --max-cpu-loras=128 --max-lora-rank=16', server_init_time=1800, disable_log_stats=False, total_time=3600, adapter_rates=[0.8, 0.0125, 0.003125], aggregated_rate=None, use_extended_metric_checker=False, lora_pre_loading=False)
Server started
Number of adapters: 128
Adapter rates. Values: [0.003125 0.0125   0.8     ]. Counts: [42 43 43]
Adapter prompts. [8640, 135, 8640, 8640, 33, 33, 8640, 33, 135, 135, 135, 33, 8640, 135, 33, 8640, 135, 33, 33, 33, 33, 135, 135, 8640, 135, 33, 135, 135, 135, 135, 8640, 135, 33, 135, 33, 8640, 8640, 33, 135, 135, 33, 135, 33, 135, 135, 8640, 8640, 8640, 8640, 135, 135, 33, 135, 8640, 8640, 135, 33, 33, 33, 8640, 135, 135, 135, 135, 8640, 135, 8640, 33, 33, 135, 33, 8640, 8640, 33, 33, 135, 135, 135, 33, 8640, 33, 8640, 135, 33, 8640, 8640, 135, 135, 33, 33, 33, 8640, 8640, 8640, 8640, 8640, 8640, 8640, 8640, 33, 8640, 33, 33, 8640, 135, 8640, 8640, 135, 8640, 33, 135, 8640, 33, 8640, 135, 33, 135, 135, 8640, 8640, 33, 33, 8640, 33, 33, 33, 135, 33]
Prompts retrieved: 378711 . Total input tokens: 84434790 . Total output tokens: 75692348
Prompts distributed
Error while running usage checker: HTTPConnectionPool(host='localhost', port=38872): Max retries exceeded with url: /metrics/ (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f54235a8ef0>: Failed to establish a new connection: [Errno 99] Cannot assign requested address'))
Error while running usage checker: HTTPConnectionPool(host='localhost', port=38872): Max retries exceeded with url: /metrics/ (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f541ea8c110>: Failed to establish a new connection: [Errno 99] Cannot assign requested address'))
Error while running usage checker: HTTPConnectionPool(host='localhost', port=38872): Max retries exceeded with url: /metrics/ (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f541ea8ca70>: Failed to establish a new connection: [Errno 99] Cannot assign requested address'))
Error while running usage checker: HTTPConnectionPool(host='localhost', port=38872): Max retries exceeded with url: /metrics/ (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f541ea8d910>: Failed to establish a new connection: [Errno 99] Cannot assign requested address'))
Error while running usage checker: HTTPConnectionPool(host='localhost', port=38872): Max retries exceeded with url: /metrics/ (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f54235b8aa0>: Failed to establish a new connection: [Errno 99] Cannot assign requested address'))
Error while running usage checker: HTTPConnectionPool(host='localhost', port=38872): Max retries exceeded with url: /metrics/ (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f541ea8d760>: Failed to establish a new connection: [Errno 99] Cannot assign requested address'))
Error while running usage checker: HTTPConnectionPool(host='localhost', port=38872): Max retries exceeded with url: /metrics/ (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f541ea8c350>: Failed to establish a new connection: [Errno 99] Cannot assign requested address'))
Error while running usage checker: HTTPConnectionPool(host='localhost', port=38872): Max retries exceeded with url: /metrics/ (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f541ea8c590>: Failed to establish a new connection: [Errno 99] Cannot assign requested address'))
Error while running usage checker: HTTPConnectionPool(host='localhost', port=38872): Max retries exceeded with url: /metrics/ (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f541ea8cb60>: Failed to establish a new connection: [Errno 99] Cannot assign requested address'))
Error while running usage checker: HTTPConnectionPool(host='localhost', port=38872): Max retries exceeded with url: /metrics/ (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f541ea8ed20>: Failed to establish a new connection: [Errno 99] Cannot assign requested address'))
Error while running usage checker: HTTPConnectionPool(host='localhost', port=38872): Max retries exceeded with url: /metrics/ (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f54235ab920>: Failed to establish a new connection: [Errno 99] Cannot assign requested address'))
Error while running usage checker: HTTPConnectionPool(host='localhost', port=38872): Max retries exceeded with url: /metrics/ (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f541ea8ecc0>: Failed to establish a new connection: [Errno 99] Cannot assign requested address'))
Error while running usage checker: HTTPConnectionPool(host='localhost', port=38872): Max retries exceeded with url: /metrics/ (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f541ea8e6f0>: Failed to establish a new connection: [Errno 99] Cannot assign requested address'))
Error while running usage checker: HTTPConnectionPool(host='localhost', port=38872): Max retries exceeded with url: /metrics/ (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f541ea8c800>: Failed to establish a new connection: [Errno 99] Cannot assign requested address'))
Error while running usage checker: HTTPConnectionPool(host='localhost', port=38872): Max retries exceeded with url: /metrics/ (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f541ea8c110>: Failed to establish a new connection: [Errno 99] Cannot assign requested address'))
Concurrent checker started
Starting initial single prompt test run for base model
Initial test run completed. Starting main benchmark run...
===== Serving Benchmark Intermediate Result ======
Successful requests:                     98673     
Benchmark duration (s):                  3601.82   
Total input tokens:                      22032319  
Total generated tokens:                  18791116  
Request throughput (req/s):              27.40     
Input token throughput (tok/s):          6116.99   
Output token throughput (tok/s):         5217.11   
---------------Time to First Token----------------
Mean TTFT (ms):                          370586.34 
Median TTFT (ms):                        377412.16 
P99 TTFT (ms):                           732722.40 
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          181.31    
Median TPOT (ms):                        179.83    
P99 TPOT (ms):                           272.68    
---------------Inter-token Latency----------------
Mean ITL (ms):                           181.01    
Median ITL (ms):                         173.59    
P99 ITL (ms):                            645.80    
==================================================
Concurrent checker terminated
Server terminated
